<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PF 2026 — FIS VŠE</title>
<style>
  body {
    background-color: #000;
    color: #00b050;
    font-family: "Courier New", monospace;
    margin: 0;
    padding: 20px;
    transition: background-color 0.2s;
  }

  #terminal {
    white-space: pre-wrap;
    line-height: 1.3em;
    position: relative;
  }

  /* Blikající kurzor */
  #cursor {
    display: inline-block;
    width: 8px;
    height: 1em;
    background-color: #00b050;
    animation: blink 1s steps(1) infinite;
    vertical-align: bottom;
  }

  @keyframes blink {
    50% { opacity: 0; }
  }

  #finalImage {
    display: none;
    margin-top: 20px;
    max-width: 100%;
    border: 2px solid #00b050;
    border-radius: 5px;
  }

  #pressKey {
    margin-top: 20px;
    color: #fff;
    font-size: 0.9em;
  }

  /* Blik efekt */
  .flash {
    background-color: #00ff66 !important;
  }
</style>
</head>
<body>
<div id="terminal"></div>
<div id="pressKey">Klikni nebo stiskni libovolnou klávesu pro spuštění...</div>
<img id="finalImage" src="placeholder.png" alt="PF FIS 2026">

<script>
const terminal = document.getElementById("terminal");
const finalImage = document.getElementById("finalImage");
const pressKey = document.getElementById("pressKey");

// ---------- Hlášky ----------
const lines = [
  "C:\\FIS> run PF2026.exe",
  "Initializing PF2026.exe ...",
  "Connecting to FIS mainframe ...",
  "Compiling data happiness.dll ... ok",
  "Loading joy modules ........... done",
  "Rendering festive vibes ...",
  "PF 2026 — Fakulta informatiky a statistiky"
];

// ---------- Kurzour ----------
const cursor = document.createElement("span");
cursor.id = "cursor";
terminal.appendChild(cursor);

// ---------- Zvuk ----------
const clickSoundUrl = "https://cdn.pixabay.com/download/audio/2022/03/15/audio_5bfb7b0f24.mp3?filename=typewriter-key-1-117234.mp3";
const clickAudio = new Audio(clickSoundUrl);
clickAudio.volume = 0.2;

function playClick() {
  const sound = clickAudio.cloneNode();
  sound.play().catch(()=>{});
}

// ---------- Efekt psaní ----------
function typeLine(line, delay = 40) {
  return new Promise(resolve => {
    let i = 0;
    function next() {
      if (i < line.length) {
        cursor.insertAdjacentText("beforebegin", line[i]);
        playClick();
        i++;
        setTimeout(next, delay);
      } else {
        cursor.insertAdjacentText("beforebegin", "\n");
        resolve();
      }
    }
    next();
  });
}

// ---------- Hlavní animace ----------
async function runTerminal() {
  pressKey.style.display = "none";
  for (const line of lines) {
    await typeLine(line);
    await new Promise(r => setTimeout(r, 300));
  }

  // Po skončení psaní -> loading bar
  await showLoadingBar();
}

// ---------- Loading bar ----------
async function showLoadingBar() {
  const barLine = document.createElement("div");
  barLine.textContent = "Loading final image: [";
  terminal.appendChild(barLine);

  let progress = 0;
  const total = 30;

  const interval = setInterval(() => {
    if (progress < total) {
      barLine.textContent = `Loading final image: [${"=".repeat(progress)}${" ".repeat(total - progress)}] ${Math.floor((progress / total) * 100)}%`;
      playClick();
      progress++;
    } else {
      clearInterval(interval);
      barLine.textContent = `Loading final image: [${"=".repeat(total)}] 100%\n`;
      flashScreen();
    }
  }, 100);
}

// ---------- Blik efekt + obrázek ----------
function flashScreen() {
  document.body.classList.add("flash");
  setTimeout(() => {
    document.body.classList.remove("flash");
    finalImage.style.display = "block";
  }, 150); // krátký flash
}

// ---------- Spuštění po kliku ----------
function startWithSound() {
  clickAudio.play().then(() => {
    clickAudio.pause();
    clickAudio.currentTime = 0;
    runTerminal();
  }).catch(() => {
    runTerminal();
  });

  document.body.removeEventListener("click", startWithSound);
  document.body.removeEventListener("keydown", startWithSound);
}

document.body.addEventListener("click", startWithSound);
document.body.addEventListener("keydown", startWithSound);
</script>
</body>
</html>
