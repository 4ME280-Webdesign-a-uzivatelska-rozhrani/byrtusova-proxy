<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PF 2026 — FIS VŠE</title>
<style>
  body {
    background-color: #000;
    color: #00b050;
    font-family: "Courier New", monospace;
    margin: 0;
    padding: 20px;
  }

  #terminal {
    white-space: pre-wrap;
    line-height: 1.3em;
    position: relative;
  }

  /* Blikající kurzor */
  #cursor {
    display: inline-block;
    width: 8px;
    height: 1em;
    background-color: #00b050;
    animation: blink 1s steps(1) infinite;
    vertical-align: bottom;
  }

  @keyframes blink {
    50% {
      opacity: 0;
    }
  }

  #finalImage {
    display: none;
    margin-top: 20px;
    max-width: 100%;
    border: 2px solid #00b050;
    border-radius: 5px;
  }

  #pressKey {
    display: none;
    margin-top: 10px;
    color: #fff;
    font-size: 0.9em;
  }
</style>
</head>
<body>
<div id="terminal"></div>
<div id="pressKey">Press any key to continue...</div>
<img id="finalImage" src="placeholder.png" alt="PF FIS 2026">

<script>
// ---------- ELEMENTY ----------
const terminal = document.getElementById("terminal");
const finalImage = document.getElementById("finalImage");
const pressKey = document.getElementById("pressKey");

// ---------- HLÁŠKY ----------
const lines = [
  "C:\\FIS> run PF2026.exe",
  "Initializing PF2026.exe ...",
  "Connecting to FIS mainframe ...",
  "Compiling data happiness.dll ... ok",
  "Loading joy modules ........... done",
  "Rendering festive vibes ...",
  "PF 2026 — Fakulta informatiky a statistiky"
];

// ---------- KURZOR ----------
const cursor = document.createElement("span");
cursor.id = "cursor";
terminal.appendChild(cursor);

// ---------- ZVUK ----------
let audioEnabled = false;
const typeSound = new Audio("https://cdn.pixabay.com/download/audio/2022/03/15/audio_5bfb7b0f24.mp3?filename=typewriter-key-1-117234.mp3");
typeSound.volume = 0.2;

// krátký klik
function playClick() {
  if (!audioEnabled) return;
  const click = typeSound.cloneNode();
  click.play().catch(()=>{});
}

// ---------- PSANÍ ----------
function typeLine(line, delay = 40) {
  return new Promise(resolve => {
    let i = 0;
    function next() {
      if (i < line.length) {
        cursor.insertAdjacentText("beforebegin", line[i]);
        playClick();
        i++;
        setTimeout(next, delay);
      } else {
        cursor.insertAdjacentText("beforebegin", "\n");
        resolve();
      }
    }
    next();
  });
}

// ---------- ANIMACE ----------
async function runTerminal() {
  for (const line of lines) {
    await typeLine(line);
    await new Promise(r => setTimeout(r, 300));
  }
  pressKey.style.display = "block";
}

// ---------- LOADING BAR ----------
async function showLoadingBar() {
  pressKey.style.display = "none";

  const barLine = document.createElement("div");
  barLine.textContent = "Loading final image: [";
  terminal.appendChild(barLine);

  let progress = 0;
  const total = 30;

  const interval = setInterval(() => {
    if (progress < total) {
      barLine.textContent = `Loading final image: [${"=".repeat(progress)}${" ".repeat(total - progress)}] ${Math.floor((progress / total) * 100)}%`;
      playClick();
      progress++;
    } else {
      clearInterval(interval);
      barLine.textContent = `Loading final image: [${"=".repeat(total)}] 100%\n`;
      setTimeout(() => {
        finalImage.style.display = "block";
      }, 500);
    }
  }, 100);
}

// ---------- INTERAKCE ----------
function enableAudioAndContinue() {
  // odemknutí zvuku – user gesture required
  typeSound.play().then(() => {
    typeSound.pause();
    typeSound.currentTime = 0;
    audioEnabled = true;
    showLoadingBar();
  }).catch(() => {
    // i bez zvuku jede dál
    showLoadingBar();
  });
  document.body.removeEventListener("click", enableAudioAndContinue);
  document.body.removeEventListener("keydown", enableAudioAndContinue);
}

document.body.addEventListener("click", enableAudioAndContinue);
document.body.addEventListener("keydown", enableAudioAndContinue);

// ---------- START ----------
runTerminal();
</script>
</body>
</html>
